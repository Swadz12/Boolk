@page "/register"
@inject UserService UserService
@inject NavigationManager Nav

<PageTitle>Register - Boolk</PageTitle>

<div class="container" style="display: flex; justify-content: center; align-items: center; min-height: 80vh; padding: 2rem;">
    <div class="card" style="max-width: 400px; width: 100%; padding: 2rem;">
        <div class="card-header">
            <h2 class="card-title">âœ¨ Register</h2>
        </div>

        <div class="card-body" style="display: flex; flex-direction: column; gap: 1rem;">
            <EditForm Model="registerModel" OnValidSubmit="HandleRegister">
                <DataAnnotationsValidator />
                
                <div class="form-group">
                    <label>Email</label>
                    <InputText @bind-Value="registerModel.Email" type="email" class="form-control" placeholder="Enter your email" />
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <InputText @bind-Value="registerModel.Password" type="password" class="form-control" placeholder="Enter your password" />
                </div>

                <button class="btn btn-primary" type="submit" disabled="@isSubmitting">
                    @(isSubmitting ? "Loading..." : "Register")
                </button>
            </EditForm>
        </div>

        <div class="card-footer" style="text-align: center; margin-top: 1rem;">
            <a href="/login">Already have an account? Login</a>
        </div>
    </div>
</div>

@code {
    private bool isSubmitting = false;
    private RegisterModel registerModel = new();

    private async Task HandleRegister()
    {
        isSubmitting = true;
        try
        {
            await UserService.RegisterUser(registerModel.Email, registerModel.Password);
            Nav.NavigateTo("/profile");
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        finally
        {
            isSubmitting = false;
        }
    }

    class RegisterModel { public string Email { get; set; } = ""; public string Password { get; set; } = ""; }
}
